digraph events {
  node [shape=record];

  user_input   [label = "User Input"];
  fire_event   [label = "Fire Event"];
  rotate_event [label = "Rotate Event"];
  simulation_reset [label = "Simulation Reset"];
  route_fire   [label = "Route Fire Event"];
  route_rotate [label = "Route Rotate Event"];
  simulation   [label = "Simulation"];
  broadcast    [label = "Broadcast"];
  broadcast_except    [label = "Broadcast Except Self"];
  collision_event [label = "Collision Event"];

  physics [label = "Physics"];

  physics -> simulation [dir=both];

  user_input -> rotate_event -> route_rotate;
  user_input -> fire_event -> route_fire -> broadcast;
  rotate_event -> simulation;
  simulation_reset -> broadcast;
  broadcast -> simulation;

  route_rotate -> broadcast_except;

  subgraph cluster_server {
	  subgraph cluster_server_o {
		  {rank=same simulation_reset collision_event}
	  }
	  subgraph cluster_server_r {
		  {rank=same route_fire route_rotate}
	  }
  }

}